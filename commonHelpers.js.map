{"version":3,"file":"commonHelpers.js","sources":["../src/js/request-api.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\n\nasync function fetchImageByRequest(userRequest, page) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const KEY = '37675395-9e31173c5a3e62573866f9f7d';\n  const options = {\n    key: KEY,\n    q: userRequest,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n    page,\n  };\n\n  const response = await axios.get(\n    `${BASE_URL}?key=${KEY}&q=${userRequest}&per_page=40&image_type=photo&orientation=horizontal&safesearch=true&page=${page}`,\n    options\n  );\n  return response;\n}\nexport { fetchImageByRequest };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { Notify } from 'notiflix';\nimport { fetchImageByRequest } from './request-api';\n\nlet page = 1;\nconst per_page = 40;\n\nconst gallery = new SimpleLightbox('.gallery a');\n\nconst loadMoreBtn = document.querySelector('.load-more');\nconst galleryContainer = document.querySelector('.gallery');\nconst form = document.querySelector('.search-form');\n\nform.addEventListener('submit', onInputSearch);\n\nloadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\n\nfunction hideBtn() {\n  loadMoreBtn.classList.add('hidden-btn');\n}\n\nasync function onInputSearch(event) {\n  event.preventDefault();\n  galleryContainer.innerHTML = '';\n  hideBtn();\n\n  const userRequest = event.target.elements.searchQuery.value;\n\n  try {\n\n    if (!userRequest.trim().length) {\n      Notify.failure('Please fill out the search field.');\n\n    } else {\n      localStorage.setItem('currentRequest', userRequest);\n      const { data } = await fetchImageByRequest(userRequest, (page = 1));\n      if (!data.hits.length) {\n        // throw new Error(\n          Notify.failure('Sorry, there are no images matching your search query. Please try again.');\n          // iziToast.error({\n          //   message: `Sorry, there are no images matching your search query. Please try again.`,\n          //   position: 'topRight',\n          //   timeout: 4000,\n          //   closeOnClick: true,\n          // });\n        // );\n      }\n\n      // Notify.info(`Hooray! We found ${data.totalHits} images.`);\n      iziToast.info({\n        message: `Hooray! We found ${data.totalHits} images.`,\n        position: 'topRight',\n        timeout: 5000,\n        closeOnClick: true,\n      });\n      renderImages(data.hits);\n      gallery.refresh();\n      if (data.hits.length < 40) {\n        hideBtn();\n        setTimeout(() => {\n          // Notify.info(\"We're sorry, but you've reached the end of search results.\");\n          iziToast.info({\n            message: \"We're sorry, but you've reached the end of search results.\",\n            position: 'topRight',\n            timeout: 5000,\n            closeOnClick: true,\n          });\n        }, 2000);\n      } else {\n        loadMoreBtn.classList.remove('hidden-btn');\n      }\n    }\n  } catch (error) {\n    console.log(error);\n    console.log(error.message);\n  }\n  \n  form.reset();\n}\n\nasync function onLoadMoreBtnClick() {\n  page += 1;\n  const currentRequest = localStorage.getItem('currentRequest');\n  try {\n    const { data } = await fetchImageByRequest(currentRequest, page);\n\n    renderImages(data.hits);\n    gallery.refresh();\n\n    if (data.hits.length < 40) {\n      hideBtn();\n      setTimeout(() => {\n        // Notify.info(\"We're sorry, but you've reached the end of search results.\");\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'topRight',\n          timeout: 4000,\n          closeOnClick: true,\n        });\n      }, 1000);\n    }\n    // })\n  } catch (error) {\n    console.log(error);\n    console.log(error.message);\n  }\n}\n\nfunction renderImages(arr) {\n  const markup = arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        }) => `\n          <div class=\"photo-card\">\n            <a href=\"${largeImageURL}\" class=\"gallery__link\">\n              <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" class=\"gallery__image\" width=\"300\"/>\n              <div class=\"info\">\n                <p class=\"info-item\">\n                  <b>Likes</b> <span>${likes}&nbsp</span>\n                </p>\n                <p class=\"info-item\">\n                  <b>Views</b> <span>${views}&nbsp</span>\n                </p>\n                <p class=\"info-item\">\n                  <b>Comments</b> <span>${comments}&nbsp</span>\n                </p>\n                <p class=\"info-item\">\n                  <b>Downloads</b> <span>${downloads}</span>\n                </p> \n              </div>\n            </a>\n          </div>\n        `)\n    .join('');\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n}\n"],"names":["fetchImageByRequest","userRequest","page","BASE_URL","KEY","options","axios","gallery","SimpleLightbox","loadMoreBtn","galleryContainer","form","onInputSearch","onLoadMoreBtnClick","hideBtn","event","Notify","data","iziToast","renderImages","error","currentRequest","arr","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads"],"mappings":"2wBAEA,eAAeA,EAAoBC,EAAaC,EAAM,CACpD,MAAMC,EAAW,2BACXC,EAAM,qCACNC,EAAU,CACd,IAAKD,EACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAC,CACJ,EAME,OAJiB,MAAMI,EAAM,IAC3B,GAAGH,SAAgBC,OAASH,8EAAwFC,IACpHG,CACJ,CAEA,CCZA,IAAIH,EAAO,EAGX,MAAMK,EAAU,IAAIC,EAAe,YAAY,EAEzCC,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAmB,SAAS,cAAc,UAAU,EACpDC,EAAO,SAAS,cAAc,cAAc,EAElDA,EAAK,iBAAiB,SAAUC,CAAa,EAE7CH,EAAY,iBAAiB,QAASI,CAAkB,EAExD,SAASC,GAAU,CACjBL,EAAY,UAAU,IAAI,YAAY,CACxC,CAEA,eAAeG,EAAcG,EAAO,CAClCA,EAAM,eAAc,EACpBL,EAAiB,UAAY,GAC7BI,IAEA,MAAMb,EAAcc,EAAM,OAAO,SAAS,YAAY,MAEtD,GAAI,CAEF,GAAI,CAACd,EAAY,KAAM,EAAC,OACtBe,SAAO,QAAQ,mCAAmC,MAE7C,CACL,aAAa,QAAQ,iBAAkBf,CAAW,EAClD,KAAM,CAAE,KAAAgB,CAAI,EAAK,MAAMjB,EAAoBC,EAAcC,EAAO,GAC3De,EAAK,KAAK,QAEXD,SAAO,QAAQ,0EAA0E,EAW7FE,EAAS,KAAK,CACZ,QAAS,oBAAoBD,EAAK,oBAClC,SAAU,WACV,QAAS,IACT,aAAc,EACtB,CAAO,EACDE,EAAaF,EAAK,IAAI,EACtBV,EAAQ,QAAO,EACXU,EAAK,KAAK,OAAS,IACrBH,IACA,WAAW,IAAM,CAEfI,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,QAAS,IACT,aAAc,EAC1B,CAAW,CACF,EAAE,GAAI,GAEPT,EAAY,UAAU,OAAO,YAAY,CAE5C,CACF,OAAQW,EAAP,CACA,QAAQ,IAAIA,CAAK,EACjB,QAAQ,IAAIA,EAAM,OAAO,CAC1B,CAEDT,EAAK,MAAK,CACZ,CAEA,eAAeE,GAAqB,CAClCX,GAAQ,EACR,MAAMmB,EAAiB,aAAa,QAAQ,gBAAgB,EAC5D,GAAI,CACF,KAAM,CAAE,KAAAJ,CAAI,EAAK,MAAMjB,EAAoBqB,EAAgBnB,CAAI,EAE/DiB,EAAaF,EAAK,IAAI,EACtBV,EAAQ,QAAO,EAEXU,EAAK,KAAK,OAAS,KACrBH,IACA,WAAW,IAAM,CAEfI,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,WACV,QAAS,IACT,aAAc,EACxB,CAAS,CACF,EAAE,GAAI,EAGV,OAAQE,EAAP,CACA,QAAQ,IAAIA,CAAK,EACjB,QAAQ,IAAIA,EAAM,OAAO,CAC1B,CACH,CAEA,SAASD,EAAaG,EAAK,CACzB,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAc;AAAA;AAAA,uBAESL;AAAA,0BACGD,WAAsBE;AAAA;AAAA;AAAA,uCAGTC;AAAA;AAAA;AAAA,uCAGAC;AAAA;AAAA;AAAA,0CAGGC;AAAA;AAAA;AAAA,2CAGCC;AAAA;AAAA;AAAA;AAAA;AAAA,SAKlC,EACJ,KAAK,EAAE,EACVpB,EAAiB,mBAAmB,YAAaa,CAAM,CACzD"}