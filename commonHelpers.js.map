{"version":3,"file":"commonHelpers.js","sources":["../src/js/request-api.js","../src/js/index.js"],"sourcesContent":["import axios from 'axios';\n\nasync function fetchImageByRequest(userRequest, page) {\n  const BASE_URL = 'https://pixabay.com/api/';\n  const KEY = '37675395-9e31173c5a3e62573866f9f7d';\n  const options = {\n    key: KEY,\n    q: userRequest,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 40,\n    page,\n  };\n\n  const response = await axios.get(\n    `${BASE_URL}?key=${KEY}&q=${userRequest}&per_page=40&image_type=photo&orientation=horizontal&safesearch=true&page=${page}`,\n    options\n  );\n  return response;\n}\nexport { fetchImageByRequest };\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { Notify } from 'notiflix';\nimport { fetchImageByRequest } from './request-api';\n\nlet page = 1;\nconst loadMoreBtn = document.querySelector('.load-more');\nconst galleryContainer = document.querySelector('.gallery');\nconst form = document.querySelector('.search-form');\nform.addEventListener('submit', onInputSearch);\n\nfunction hideBtn() {\n  loadMoreBtn.classList.add('hidden-btn');\n}\n\nfunction onInputSearch(event) {\n  event.preventDefault();\n  galleryContainer.innerHTML = '';\n  hideBtn();\n\n  const userRequest = event.target.elements.searchQuery.value;\n  if (!userRequest.trim().length) {\n      Notify.failure('Please fill out the search field.');\n  \n    //   iziToast.warning({\n    //     message: 'This is the last page of Gallery',\n    //     position: 'topRight',\n    //     timeout: 5000,\n    //     closeOnClick: true,\n    //   });      \n  } else {\n    localStorage.setItem('currentRequest', userRequest);\n\n    fetchImageByRequest(userRequest, (page = 1))\n      .then(response => {\n        if (!response.data.hits.length) {\n          throw new Error(\n            // Notify.failure('Sorry, there are no images matching your search query. Please try again.')\n            iziToast.error({\n                message: `Sorry, there are no images matching your search query. Please try again.`,\n                position: 'topRight',\n                timeout: 4000,\n                closeOnClick: true,\n            })               \n          );\n        }\n\n        // Notify.success(`Hooray! We found ${response.data.totalHits} images.`);\n        iziToast.info({\n            // title: 'Hooray!',\n            message: `Hooray! We found ${response.data.totalHits} images.`,\n            position: 'topRight',\n            timeout: 5000,\n            closeOnClick: true,\n        });         \n        renderImages(response.data.hits);\n        if (response.data.hits.length < 40) {\n          hideBtn();\n          setTimeout(() => {\n              Notify.info(\"We're sorry, but you've reached the end of search results.\");\n            // iziToast.info({\n            //     message: We're sorry, but you've reached the end of search results.\",\n            //     position: 'topRight',\n            //     timeout: 5000,\n            //     closeOnClick: true,\n            // });                   \n          }, 2000);\n        } else {\n          loadMoreBtn.classList.remove('hidden-btn');\n        }\n      })\n      .catch(error => console.log(error));\n  }\n\n  form.reset();\n}\n\nfunction renderImages(arr) {\n  const markup = arr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n        }) => `\n      <div class=\"photo-card\">\n        <a href=\"${largeImageURL}\" class=\"gallery__link\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" class=\"gallery__image\" width=\"300\"/>\n            <div class=\"info\">\n                <p class=\"info-item\">\n                <b>Likes</b> <span>${likes}&nbsp</span>\n                </p>\n                <p class=\"info-item\">\n                <b>Views</b> <span>${views}&nbsp</span>\n                </p>\n                <p class=\"info-item\">\n                <b>Comments</b> <span>${comments}&nbsp</span>\n                </p>\n                <p class=\"info-item\">\n                <b>Downloads</b> <span>${downloads}</span>\n                </p> \n            </div>\n        </a>\n      </div>\n    `)\n    .join('');\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n\n  const gallery = new SimpleLightbox('.gallery a');\n  gallery.refresh();\n}\n\nloadMoreBtn.addEventListener('click', onLoadMoreBtnClick);\nfunction onLoadMoreBtnClick() {\n  page += 1;\n  const currentRequest = localStorage.getItem('currentRequest');\n\n  fetchImageByRequest(currentRequest, page)\n    .then(response => {\n      renderImages(response.data.hits);\n      if (response.data.hits.length < 40) {\n        hideBtn();\n        setTimeout(() => {\n        //   Notify.info(\"We're sorry, but you've reached the end of search results.\");\n            iziToast.info({\n                message: \"We're sorry, but you've reached the end of search results.\",\n                position: 'topRight',\n                timeout: 4000,\n                closeOnClick: true,\n            });                 \n        }, 2000);\n      }\n    })\n    .catch(error => console.log(error));\n}\n"],"names":["fetchImageByRequest","userRequest","page","BASE_URL","KEY","options","axios","loadMoreBtn","galleryContainer","form","onInputSearch","hideBtn","event","response","iziToast","renderImages","Notify","error","arr","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","onLoadMoreBtnClick","currentRequest"],"mappings":"2wBAEA,eAAeA,EAAoBC,EAAaC,EAAM,CACpD,MAAMC,EAAW,2BACXC,EAAM,qCACNC,EAAU,CACd,IAAKD,EACL,EAAGH,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAAC,CACJ,EAME,OAJiB,MAAMI,EAAM,IAC3B,GAAGH,SAAgBC,OAASH,8EAAwFC,IACpHG,CACJ,CAEA,CCZA,IAAIH,EAAO,EACX,MAAMK,EAAc,SAAS,cAAc,YAAY,EACjDC,EAAmB,SAAS,cAAc,UAAU,EACpDC,EAAO,SAAS,cAAc,cAAc,EAClDA,EAAK,iBAAiB,SAAUC,CAAa,EAE7C,SAASC,GAAU,CACjBJ,EAAY,UAAU,IAAI,YAAY,CACxC,CAEA,SAASG,EAAcE,EAAO,CAC5BA,EAAM,eAAc,EACpBJ,EAAiB,UAAY,GAC7BG,IAEA,MAAMV,EAAcW,EAAM,OAAO,SAAS,YAAY,MACjDX,EAAY,KAAM,EAAC,QAUtB,aAAa,QAAQ,iBAAkBA,CAAW,EAElDD,EAAoBC,EAAcC,EAAO,CAAG,EACzC,KAAKW,GAAY,CAChB,GAAI,CAACA,EAAS,KAAK,KAAK,OACtB,MAAM,IAAI,MAERC,EAAS,MAAM,CACX,QAAS,2EACT,SAAU,WACV,QAAS,IACT,aAAc,EAC9B,CAAa,CACb,EAIQA,EAAS,KAAK,CAEV,QAAS,oBAAoBD,EAAS,KAAK,oBAC3C,SAAU,WACV,QAAS,IACT,aAAc,EAC1B,CAAS,EACDE,EAAaF,EAAS,KAAK,IAAI,EAC3BA,EAAS,KAAK,KAAK,OAAS,IAC9BF,IACA,WAAW,IAAM,CACbK,SAAO,KAAK,4DAA4D,CAO3E,EAAE,GAAI,GAEPT,EAAY,UAAU,OAAO,YAAY,CAEnD,CAAO,EACA,MAAMU,GAAS,QAAQ,IAAIA,CAAK,CAAC,GAjDlCD,SAAO,QAAQ,mCAAmC,EAoDtDP,EAAK,MAAK,CACZ,CAEA,SAASM,EAAaG,EAAK,CACzB,MAAMC,EAASD,EACZ,IACC,CAAC,CACC,aAAAE,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IAAc;AAAA;AAAA,mBAEKL;AAAA,wBACKD,WAAsBE;AAAA;AAAA;AAAA,qCAGTC;AAAA;AAAA;AAAA,qCAGAC;AAAA;AAAA;AAAA,wCAGGC;AAAA;AAAA;AAAA,yCAGCC;AAAA;AAAA;AAAA;AAAA;AAAA,KAKpC,EACA,KAAK,EAAE,EACVlB,EAAiB,mBAAmB,YAAaW,CAAM,EAEvC,IAAIQ,EAAe,YAAY,EACvC,QAAO,CACjB,CAEApB,EAAY,iBAAiB,QAASqB,CAAkB,EACxD,SAASA,GAAqB,CAC5B1B,GAAQ,EACR,MAAM2B,EAAiB,aAAa,QAAQ,gBAAgB,EAE5D7B,EAAoB6B,EAAgB3B,CAAI,EACrC,KAAKW,GAAY,CAChBE,EAAaF,EAAS,KAAK,IAAI,EAC3BA,EAAS,KAAK,KAAK,OAAS,KAC9BF,IACA,WAAW,IAAM,CAEbG,EAAS,KAAK,CACV,QAAS,6DACT,SAAU,WACV,QAAS,IACT,aAAc,EAC9B,CAAa,CACJ,EAAE,GAAI,EAEf,CAAK,EACA,MAAMG,GAAS,QAAQ,IAAIA,CAAK,CAAC,CACtC"}